# output directory and log
AN_OUT, AN_LOG = prepare_environment('Analysis')


# include sub rules
include:
    "MGMT.rules"


def analysis_output_files():
    all = expand("{dir}/{name}", name=[
                 "MT.read_counts.txt",
                 "MG.read_counts.txt",
                 #### Added this ####
                 "MG.annotation.bed",
                 "MG.gene_depth.hist",
                 "MG.gene_depth.avg",
                 "MG.gene.len",
                 "MG.prokkaID2ec.txt",
                 "MT.annotation.bed",
                 "MT.gene_depth.hist",
                 "MT.gene_depth.avg",
                 "MT.gene.len",
                 "MT.prokkaID2ec.txt",
                 #####################
                 "MG.variants.isec.vcf.gz",
                 "MT.variants.isec.vcf.gz",
                 "MGMT.assembly.length.txt",
                 "MGMT.assembly.gc_content.txt",
                 "MT.assembly.contig_coverage.txt",
                 "MT.assembly.contig_depth.txt",
                 "MT.assembly.contig_flagstat.txt",
                 "MG.assembly.contig_coverage.txt",
                 "MG.assembly.contig_depth.txt",
                 "MG.assembly.contig_flagstat.txt",
                 "MGMT.vizbin.points",
                 "MGMT.vizbin.filtered.fa",
                 #### Added this ####
                 #"results/MT.gene_kegg_krona.txt",
                 #"results/MT.gene_kegg_krona.html",
                 #"results/MG.gene_kegg_krona.txt",
                 #"results/MG.gene_kegg_krona.html",
                 #####################
                 "MGMT.vizbin.with-contig-names.points"], dir=AN_OUT)
#    stats = expand([
#                 '{dir}/{stat_flag}/{rtype}/cycle_composition_{n}.{ext}',
#                 '{dir}/{stat_flag}/{rtype}/cycle_quality_{n}.{ext}',
#                 '{dir}/{stat_flag}/{rtype}/cycle_quality_box_{n}.{ext}',
#                 '{dir}/{stat_flag}/{rtype}/info.tab',
#                 '{dir}/{stat_flag}/{rtype}/lane_tile_quality_{n}.{ext}',
#                 '{dir}/{stat_flag}/{rtype}/quality_QQ.{ext}',
#                 '{dir}/{stat_flag}/{rtype}/reads_length.{ext}',
#                 '{dir}/{stat_flag}/{rtype}/reads_quality.{ext}'],
#                 n=['1', '2'],
#                 ext=['gnuplot', 'png', 'tab'],
#                 dir=AN_OUT,
#                 stat_flag=['stats', 'stats_after_preprocessing'],
#                 rtype=['MG', 'MT'])
    plots = analysis_plot_files_output()
    return all + plots # + stats

# master command
rule ANALYSIS:
    input:
        analysis_output_files()
    shell:
        "echo 'Analysis Done'"
