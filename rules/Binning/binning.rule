rule binning_clustering:
    input:
        "Binning/ORFS.hmm.orfs.essential.hits",
    output:
        expand("Binning/clusterFiles/reachabilityDistanceEstimates{pk}{nn}.tsv \
        Binning/clusterFiles/clusterFirstScan{pk}{nn}.tsv \
        Binning/clusterFiles/bimodalClusterCutoffs{pk}{nn}.tsv \
        Binning/clusterFiles/contigs2clusters{pk}{nn}.tsv \
        Binning/clusterFiles/contigs2clusters{pk}{nn}.RDS \
        Binning/clusterFiles/finalClusterMap{pk}{nn}.pdf".split(),pk=config["binning"]["pk"],nn=config["binning"]["nn"])
    shell:
        """
        ## Run the R script for clustering the contigs
        sudo Rscript {SRCDIR}/binny.R {SAMPLE} {input} {config[binning][pk]} {config[binning][nn]}
        """
