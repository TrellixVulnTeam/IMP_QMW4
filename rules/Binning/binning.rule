rule binning_clustering:
    input:
        "Analysis/mgmt.vizbin.with-contig-names.points",
        "Analysis/mg.assembly.contig_depth.txt",
        "Binning/ORFS.hmm.orfs.essential.hits",
        "Binning/ORFS-contig_links.bed"
    output:
        "Binning/clusterFiles/reachabilityDistanceEstimates.tsv",
        "Binning/clusterFiles/clusterFirstScan.tsv",
        "Binning/clusterFiles/bimodalClusterCutoffs.tsv",
        "Binning/clusterFiles/contigs2clusters.tsv",
        "Binning/clusterFiles/contigs2clusters.RDS",
        "Binning/clusterFiles/finalClusterMap.pdf",
    shell:
        """
        ## Run the R script for clustering the contigs
        Rscript src/20160223_autoClusterFromIMP.R {input} {B_OUT}/clusterFiles {SAMPLE}
        """
